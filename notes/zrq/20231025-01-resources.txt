#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2023, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#zrq-notes-time
#zrq-notes-indent
#zrq-notes-crypto
#zrq-notes-ansible
#zrq-notes-osformat
#zrq-notes-zeppelin
#
# AIMetrics: []
#

    Target:

        Resource allocation tests.

    Result:

        Work in progress ...

# -----------------------------------------------------
# Check to see if anyone is using the live service.
#[user@desktop]

    ssh fedora@live.gaia-dmp.uk

        pushd zeppelin/logs

            sed -n '
                /Login/ p
                ' zeppelin-fedora-iris-gaia-blue-20230926-zeppelin.log

    >    INFO [2023-10-25 02:00:03,694] ({qtp1107024580-1354} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 02:00:04,166] ({qtp1107024580-1359} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 02:20:22,337] ({qtp1107024580-4957} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 02:20:23,161] ({qtp1107024580-4961} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 02:20:23,607] ({qtp1107024580-4969} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 02:40:37,734] ({qtp1107024580-8571} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 02:40:38,401] ({qtp1107024580-8575} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 02:40:38,790] ({qtp1107024580-8580} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:01:24,600] ({qtp1107024580-12242} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:01:25,200] ({qtp1107024580-12247} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:01:25,590] ({qtp1107024580-12254} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:21:27,690] ({qtp1107024580-15816} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:21:28,066] ({qtp1107024580-15821} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:21:30,988] ({qtp1107024580-15841} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:21:33,904] ({qtp1107024580-15851} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}
    >    INFO [2023-10-25 03:21:34,275] ({qtp1107024580-15856} LoginRestApi.java[postLogin]:249) - {"status":"OK","message":"","body":{"principal":"SVoutsinas","ticket":"888c038d-bf53-41cb-9781-772ec4aecd99","roles":"[]"}}

    #
    # Either Stelios is working late, or he has given his login credentials to the healthchecker.
    # No sign of our science users though.
    #


# -----------------------------------------------------
# Shutdown the live service.
#[user@desktop]

    ssh fedora@live.gaia-dmp.uk

        zeppelin-daemon.sh stop

    >   Zeppelin stop                                              [  OK  ]


# -----------------------------------------------------
# Backup the notebooks from the live service.
#[user@desktop]

    #
    # 20230517-01-backup-notebooks.txt
    #


# -----------------------------------------------------
# Check the remote backup on our data server.
#[user@desktop]

    ssh fedora@data.gaia-dmp.uk

        ls -al /var/local/backups/notebooks/

    >   ....
    >   ....
    >   drwxrwxr-x.  3 fedora fedora 4096 Oct 15 03:35 20231015-033529-live.gaia-dmp.uk-notebooks
    >   drwxrwxr-x.  3 fedora fedora 4096 Oct 23 13:51 20231023-135104-live.gaia-dmp.uk-notebooks
    >   drwxrwxr-x.  3 fedora fedora 4096 Oct 25 06:04 20231025-060421-live.gaia-dmp.uk-notebooks
    >   lrwxrwxrwx.  1 fedora fedora   42 Oct 25 06:04 latest -> 20231025-060421-live.gaia-dmp.uk-notebooks


# -----------------------------------------------------
# Check the local backup on our desktop.
#[user@desktop]

    ls -al /var/local/backups/aglais/notebooks

    >   ....
    >   ....
    >   drwxr-sr-x. 1 Zarquan users   70 Oct 23 14:52 20231023-145218-live.gaia-dmp.uk-notebooks
    >   drwxr-sr-x. 1 Zarquan users   70 Oct 25 07:06 20231025-070554-live.gaia-dmp.uk-notebooks


# -----------------------------------------------------
# -----------------------------------------------------
# Start a new client.
#[user@desktop]

    source "${HOME}/aglais.env"

    agclient red


# -----------------------------------------------------
# Delete everything from all three clouds.
#[root@ansibler]

    testclouds=(
        iris-gaia-red
        iris-gaia-green
        iris-gaia-blue
        )

    for testcloud in "${testclouds[@]}"
    do
        echo "Cloud [${testcloud}]"
        /deployments/openstack/bin/delete-all.sh \
            "${testcloud:?}"
    done

    #
    # Live service trap wprked :-)
    #

    >   ....
    >   ....
    >   ---- ---- ----
    >   Cloud name [iris-gaia-blue]
    >   ---- ---- ----
    >   You are deleting the current live system!! Do you want to proceed? (y/N) y
    >   
    >   ---- ----
    >   Deleting servers
    >   ....
    >   ....


    for testcloud in "${testclouds[@]}"
    do
        echo "Cloud [${testcloud}]"
        /deployments/openstack/bin/list-all.sh \
            "${testcloud:?}"
    done

    >   ....
    >   ....


# -----------------------------------------------------
# Create a network, subnet, router and keypair on each test cloud.
#[root@ansibler]

    for cloudname in "${testclouds[@]}"
    do
        echo ""
        echo "Cloud [${cloudname}]"

        rm -f "/opt/aglais/${cloudname:?}-status.yml"

        ansible-playbook \
            --inventory 'bootstrap,' \
            '/deployments/cluster-api/bootstrap/ansible/00-init-status.yml'

        ansible-playbook \
            --inventory 'bootstrap,' \
            '/deployments/cluster-api/bootstrap/ansible/01-create-keypair.yml'

        ansible-playbook \
            --inventory 'bootstrap,' \
            '/deployments/cluster-api/bootstrap/ansible/02-create-network.yml'

        mv "/opt/aglais/aglais-status.yml" \
           "/opt/aglais/${cloudname:?}-status.yml"
    done


# -----------------------------------------------------
# Create our lookup functions.
#[root@ansibler]

    getnetworkid()
        {
        local testcloud=${1:?}
        yq '
           .aglais.openstack.networks.bootstrap.network.id
           ' "/opt/aglais/${testcloud:?}-status.yml"
        }

    getkeypairid()
        {
        local testcloud=${1:?}
        yq '
           .aglais.openstack.keypairs.team.id
           ' "/opt/aglais/${testcloud:?}-status.yml"
        }

    getimageid()
        {
        local testcloud=${1:?}
        local imagename=${2:?}
        openstack \
            --os-cloud "${testcloud:?}" \
            image list \
                --format json \
        | jq -r \
            --arg imagename "${imagename:?}" \
            '
            .[]
            | select(.Name == $imagename)
            | .ID
            '
        }

    getflavorid()
        {
        local testcloud=${1:?}
        local flavorname=${2:?}
        openstack \
            --os-cloud "${testcloud:?}" \
            flavor list \
                --format json \
        | jq -r \
            --arg flavorname "${flavorname:?}" \
            '
            .[]
            | select(.Name == $flavorname)
            | .ID
            '
        }


# -----------------------------------------------------
# Test the lookup functions.
#[root@ansibler]

    for cloudname in "${testclouds[@]}"
    do
        getnetworkid \
            "${cloudname}"
    done

    >   d52cede1-8352-4f5c-ac72-a101f3d5a26d
    >   0c6583cf-8462-41ea-b46f-3247c3058a75
    >   8fea5258-f471-423f-8a23-99238c240b3c


    for cloudname in "${testclouds[@]}"
    do
        getkeypairid \
            "${cloudname}"
    done

    >   iris-gaia-red-20231025-keypair
    >   iris-gaia-green-20231025-keypair
    >   iris-gaia-blue-20231025-keypair


    for cloudname in "${testclouds[@]}"
    do
        getimageid \
            "${cloudname}" \
            'gaia-dmp-fedora-cloud-38-1.6'
    done

    >   8b608db9-a74c-4de2-ac04-8eddb3041f39
    >   cb375d63-4b7d-4362-bf89-0bf586d503b6
    >   a00d8a08-0112-4f74-9d93-8f6756073ac0


    for cloudname in "${testclouds[@]}"
    do
        getflavorid \
            "${cloudname}" \
            'gaia.vm.cclake.54vcpu'
    done

    >   56c420d5-abea-41da-9863-f5bc08b08430
    >   56c420d5-abea-41da-9863-f5bc08b08430
    >   56c420d5-abea-41da-9863-f5bc08b08430


# -----------------------------------------------------
# Create our loop functions.
#[root@ansibler]

    delete-servers()
        {
        local testcloud=${1:?}

        echo ""
        echo "---- ----"
        echo "Deleting servers"
        echo "  Cloud [${testcloud}]"

        for serverid in $(
            openstack \
                --os-cloud "${testcloud:?}" \
                server list \
                    --format json \
            | jq -r '.[] | .ID'
            )
        do
            echo "- Deleting server [${serverid}]"
            openstack \
                --os-cloud "${testcloud:?}" \
                server delete \
                    "${serverid:?}"
        done
        }

    create-servers()
        {
        local testcloud=${1:?}
        local flavorname=${2:?}
        local testcount=${3:?}

        local imagename=gaia-dmp-fedora-cloud-38-1.6

        local imageid=$(
            getimageid "${testcloud}" "${imagename}"
            )
        local flavorid=$(
            getflavorid "${testcloud}" "${flavorname}"
            )

        local networkid=$(
            getnetworkid  "${testcloud}"
            )

        local keypairid=$(
            getkeypairid  "${testcloud}"
            )

        echo ""
        echo "---- ----"
        echo "Creating servers"
        echo "  Cloud  [${testcloud}]"
        echo "  Image  [${imagename}][${imageid}]"
        echo "  Flavor [${flavorname}][${flavorid}]"
        echo "  Count  [${testcount}]"
        echo ""

        for (( i=0 ; i < testcount ; i++))
        do

            vmname=${testcloud}-${flavorname}-$(printf '%02d' ${i})
            echo "Node [${vmname}]"

            openstack \
                --os-cloud "${testcloud:?}" \
                server create \
                --image "${imageid:?}" \
                --flavor "${flavorid:?}" \
                --nic "net-id=${networkid:?}" \
                --key-name "${keypairid}" \
                "${vmname}" \
                    --format json \
            > "/tmp/${vmname}.json"


        done
        }

    list-servers()
        {
        local testcloud=${1:?}

        echo ""
        echo "---- ----"
        echo "Listing servers"
        echo "  Cloud [${testcloud}]"

        openstack \
            --os-cloud "${testcloud:?}" \
            server list \
                --column Name \
                --column Status \
                --sort-column Name
        }


    list-active()
        {
        local testcloud=${1:?}

        echo ""
        echo "---- ----"
        echo "Listing active"
        echo "  Cloud [${testcloud}]"

        openstack \
            --os-cloud "${testcloud:?}" \
            server list \
                --format json \
        | jq '.[] | select(.Status == "ACTIVE") | .Flavor'
        }


# -----------------------------------------------------
# Start with a clean set.
#[root@ansibler]

    delete-servers \
        'iris-gaia-red'

    delete-servers \
        'iris-gaia-green'

    delete-servers \
        'iris-gaia-blue'


# -----------------------------------------------------
# Create large (54vcpu) instances on red.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.54vcpu' \
        20

    >   ---- ----
    >   Creating servers
    >     Cloud  [iris-gaia-red]
    >     Image  [gaia-dmp-fedora-cloud-38-1.6][8b608db9-a74c-4de2-ac04-8eddb3041f39]
    >     Flavor [gaia.vm.cclake.54vcpu][56c420d5-abea-41da-9863-f5bc08b08430]
    >     Count  [20]
    >   
    >   Node [iris-gaia-red-gaia.vm.cclake.54vcpu-00]
    >   Node [iris-gaia-red-gaia.vm.cclake.54vcpu-01]
    >   ....
    >   ....
    >   Node [iris-gaia-red-gaia.vm.cclake.54vcpu-18]
    >   Node [iris-gaia-red-gaia.vm.cclake.54vcpu-19]


    list-active \
        'iris-gaia-red'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.54vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.54vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"


    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.54vcpu' \
        5

    >   ---- ----
    >   Creating servers
    >     Cloud  [iris-gaia-green]
    >     Image  [gaia-dmp-fedora-cloud-38-1.6][cb375d63-4b7d-4362-bf89-0bf586d503b6]
    >     Flavor [gaia.vm.cclake.54vcpu][56c420d5-abea-41da-9863-f5bc08b08430]
    >     Count  [5]
    >   
    >   Node [iris-gaia-green-gaia.vm.cclake.54vcpu-00]
    >   Node [iris-gaia-green-gaia.vm.cclake.54vcpu-01]
    >   Node [iris-gaia-green-gaia.vm.cclake.54vcpu-02]
    >   Node [iris-gaia-green-gaia.vm.cclake.54vcpu-03]
    >   Node [iris-gaia-green-gaia.vm.cclake.54vcpu-04]


    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.54vcpu' \
        5

    >   ---- ----
    >   Creating servers
    >     Cloud  [iris-gaia-blue]
    >     Image  [gaia-dmp-fedora-cloud-38-1.6][a00d8a08-0112-4f74-9d93-8f6756073ac0]
    >     Flavor [gaia.vm.cclake.54vcpu][56c420d5-abea-41da-9863-f5bc08b08430]
    >     Count  [5]
    >   
    >   Node [iris-gaia-blue-gaia.vm.cclake.54vcpu-00]
    >   Node [iris-gaia-blue-gaia.vm.cclake.54vcpu-01]
    >   Node [iris-gaia-blue-gaia.vm.cclake.54vcpu-02]
    >   Node [iris-gaia-blue-gaia.vm.cclake.54vcpu-03]
    >   Node [iris-gaia-blue-gaia.vm.cclake.54vcpu-04]


    list-active \
        'iris-gaia-red'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.54vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.54vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   8


    list-active \
        'iris-gaia-green'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]


    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]


    #
    # 18 * 54 vcpu on red
    # total 972 vcpu
    #


# -----------------------------------------------------
# Add large (26vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.26vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.26vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.26vcpu' \
        5

    list-active \
        'iris-gaia-red'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.54vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.54vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   8


    list-active \
        'iris-gaia-green'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]


    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]


    #
    # 18 * 54 vcpu on red
    # total 972 vcpu
    #


# -----------------------------------------------------
# Add medium (12vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.12vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.12vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.12vcpu' \
        5

    list-active \
        'iris-gaia-red'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.54vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.54vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   8


    list-active \
        'iris-gaia-green'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]


    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]


    #
    # 18 * 54 vcpu on red
    # total 972 vcpu
    #


# -----------------------------------------------------
# Add medium (6vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.6vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.6vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.6vcpu' \
        5

    list-active \
        'iris-gaia-red'

    list-active \
        'iris-gaia-green'

    list-active \
        'iris-gaia-blue'


    #
    # 18 * 54 vcpu on red
    # total 972 vcpu
    #

# -----------------------------------------------------
# Add small (4vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.4vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.4vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.4vcpu' \
        5

    list-active \
        'iris-gaia-red'

    list-active \
        'iris-gaia-green'

    list-active \
        'iris-gaia-blue'

    #
    # 18 * 54 vcpu on red
    # total 972 vcpu
    #


# -----------------------------------------------------
# Add small (2vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.2vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.2vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.2vcpu' \
        5

    list-active \
        'iris-gaia-red'

    list-active \
        'iris-gaia-green'

    list-active \
        'iris-gaia-blue'

    #
    # 18 * 54 vcpu on red
    # total 972 vcpu
    #


# -----------------------------------------------------
# Start with a clean set.
#[root@ansibler]

    delete-servers \
        'iris-gaia-red'

    delete-servers \
        'iris-gaia-green'

    delete-servers \
        'iris-gaia-blue'


# -----------------------------------------------------
# Create large (26vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.26vcpu' \
        20

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.26vcpu' \
        20

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.26vcpu' \
        20

    list-active \
        'iris-gaia-red'

    list-active \
        'iris-gaia-green'

    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   20

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   6

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]

    #
    # 20 * 26 vcpu on green
    # 16 * 26 vcpu on green
    #  0 * 26 vcpu on blue
    # total 936 vcpu
    #


# -----------------------------------------------------
# Add medium (12vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.12vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.12vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.12vcpu' \
        5

    list-active \
        'iris-gaia-red'

    list-active \
        'iris-gaia-green'

    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   20

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   6

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]

    #
    # 20 * 26 vcpu on green
    # 16 * 26 vcpu on green
    #  0 * 26 vcpu on blue
    # total 936 vcpu
    #


# -----------------------------------------------------
# Add medium (6vcpu) instances.
# Add small (4vcpu) instances.
# Add small (2vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.6vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.6vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.6vcpu' \
        5

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.4vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.4vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.4vcpu' \
        5

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.2vcpu' \
        5

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.2vcpu' \
        5

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.2vcpu' \
        5

    list-active \
        'iris-gaia-red'

    list-active \
        'iris-gaia-green'

    list-active \
        'iris-gaia-blue'


    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   4
    >   
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   20

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.26vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.26vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   "gaia.vm.cclake.26vcpu"
    >   6

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]


    #
    # 20 * 26 vcpu on red
    # 16 * 26 vcpu on green
    #  4 *  2 vcpu on red
    # total 944 vcpu
    #


# -----------------------------------------------------
# Start with a clean set.
#[root@ansibler]

    delete-servers \
        'iris-gaia-red'
    delete-servers \
        'iris-gaia-green'
    delete-servers \
        'iris-gaia-blue'

    list-servers \
        'iris-gaia-red'
    list-servers \
        'iris-gaia-green'
    list-servers \
        'iris-gaia-blue'

# -----------------------------------------------------
# Create medium (12vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.12vcpu' \
        30
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.12vcpu' \
        30
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.12vcpu' \
        30

    list-active \
        'iris-gaia-red'
    list-active \
        'iris-gaia-green'
    list-active \
        'iris-gaia-blue'


    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   30

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   30

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   "gaia.vm.cclake.12vcpu"

    #
    # 30 * 12 vcpu on red
    # 30 * 12 vcpu on green
    # 12 * 12 vcpu on blue
    # total 864 vcpu
    #


# -----------------------------------------------------
# Add medium (6vcpu) instances.
# Add small (4vcpu) instances.
# Add small (2vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.6vcpu' \
        5
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.6vcpu' \
        5
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.6vcpu' \
        5

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.4vcpu' \
        5
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.4vcpu' \
        5
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.4vcpu' \
        5

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.2vcpu' \
        5
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.2vcpu' \
        5
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.2vcpu' \
        5

    list-active \
        'iris-gaia-red'
    list-active \
        'iris-gaia-green'
    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   2
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   "gaia.vm.cclake.4vcpu"
    >   2
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   30

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   30

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]
    >   "gaia.vm.cclake.12vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.12vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.12vcpu"
    >   "gaia.vm.cclake.12vcpu"
    >   2

    #
    # 30 * 12 vcpu on red
    # 30 * 12 vcpu on green
    # 12 * 12 vcpu on blue
    #  2 *  4 vcpu on red
    #  2 *  2 vcpu on red
    # total 876 vcpu
    #


# -----------------------------------------------------
# Start with a clean set.
#[root@ansibler]

    delete-servers \
        'iris-gaia-red'
    delete-servers \
        'iris-gaia-green'
    delete-servers \
        'iris-gaia-blue'

    list-servers \
        'iris-gaia-red'
    list-servers \
        'iris-gaia-green'
    list-servers \
        'iris-gaia-blue'

# -----------------------------------------------------
# Create medium (6vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.6vcpu' \
        60
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.6vcpu' \
        60
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.6vcpu' \
        60

    >   ....
    >   ....

# -----------------------------------------------------
# Add small (4vcpu) instances.
# Add small (2vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.4vcpu' \
        5
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.4vcpu' \
        5
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.4vcpu' \
        5

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.2vcpu' \
        5
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.2vcpu' \
        5
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.2vcpu' \
        5

    list-active \
        'iris-gaia-red'
    list-active \
        'iris-gaia-green'
    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   30
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   40
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   50
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   60

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   30
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   40
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   50
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   60

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   30
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.6vcpu"
    >   40
    >   
    >   "gaia.vm.cclake.6vcpu"
    >   "gaia.vm.cclake.6vcpu"
    >   2

    #
    # 60 * 6 vcpu on red
    # 60 * 6 vcpu on green
    # 42 * 6 vcpu on blue
    #
    # (60 * 6) + (60 * 6) + (42 * 6)
    # total 972 vcpu
    #


# -----------------------------------------------------
# Start with a clean set.
#[root@ansibler]

    delete-servers \
        'iris-gaia-red'
    delete-servers \
        'iris-gaia-green'
    delete-servers \
        'iris-gaia-blue'

    list-servers \
        'iris-gaia-red'
    list-servers \
        'iris-gaia-green'
    list-servers \
        'iris-gaia-blue'

# -----------------------------------------------------
# Create small (4vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.4vcpu' \
        90
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.4vcpu' \
        90
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.4vcpu' \
        90

    >   ....
    >   ....

# -----------------------------------------------------
# Add small (2vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.2vcpu' \
        5
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.2vcpu' \
        5
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.2vcpu' \
        5

    list-active \
        'iris-gaia-red'
    list-active \
        'iris-gaia-green'
    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   5
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   30
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   40
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   50
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   60
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   70
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   80
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   90

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   5
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   30
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   40
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   50
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   60
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   70
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   80
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   90

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   5
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   10
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   20
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   30
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   40
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   ....
    >   ....
    >   "gaia.vm.cclake.4vcpu"
    >   50
    >   
    >   "gaia.vm.cclake.4vcpu"
    >   "gaia.vm.cclake.4vcpu"
    >   "gaia.vm.cclake.4vcpu"
    >   "gaia.vm.cclake.4vcpu"

    #
    # (5*2) + (90*4) on red
    # (5*2) + (90*4) on green
    # (5*2) + (54*4) on blue
    #
    # (5*2) + (90*4) + (5*2) + (90*4) + (5*2) + (54*4) =
    # total 966 vcpu
    #

# -----------------------------------------------------
# Start with a clean set.
#[root@ansibler]

    delete-servers \
        'iris-gaia-red'
    delete-servers \
        'iris-gaia-green'
    delete-servers \
        'iris-gaia-blue'

    list-servers \
        'iris-gaia-red'
    list-servers \
        'iris-gaia-green'
    list-servers \
        'iris-gaia-blue'

# -----------------------------------------------------
# Create small (2vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.2vcpu' \
        200
    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.2vcpu' \
        200
    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.2vcpu' \
        200

    list-active \
        'iris-gaia-red'
    list-active \
        'iris-gaia-green'
    list-active \
        'iris-gaia-blue'

    >   
    >   [root@ansibler-red /]#
    >   [root@ansibler-red /]#     list-active \
    >           'iris-gaia-red'
    >       list-active \
    >           'iris-gaia-green'
    >       list-active \
    >           'iris-gaia-blue'
    >   
    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.2vcpu"
    >   ....
    >   ....
    >   ....
    >   ....
    >   "gaia.vm.cclake.2vcpu"
    >   100
    >   
    >   "gaia.vm.cclake.2vcpu"
    >   ....
    >   ....
    >   ....
    >   ....
    >   "gaia.vm.cclake.2vcpu"
    >   200

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.2vcpu"
    >   ....
    >   ....
    >   ....
    >   ....
    >   "gaia.vm.cclake.2vcpu"
    >   100
    >   
    >   "gaia.vm.cclake.2vcpu"
    >   ....
    >   ....
    >   ....
    >   ....
    >   "gaia.vm.cclake.2vcpu"
    >   200

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]
    >   "gaia.vm.cclake.2vcpu"
    >   ....
    >   ....
    >   ....
    >   ....
    >   "gaia.vm.cclake.2vcpu"
    >   80
    >   
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   "gaia.vm.cclake.2vcpu"
    >   6

    #
    # 200 * 2vcpu on red
    # 200 * 2vcpu on green
    #  86 * 2vcpu on blue
    #
    # (200 * 2) + (200 * 2) + (86 * 2)
    # total 972 vcpu
    #

# -----------------------------------------------------
# Start with a clean set.
#[root@ansibler]

    delete-servers \
        'iris-gaia-red'
    delete-servers \
        'iris-gaia-green'
    delete-servers \
        'iris-gaia-blue'

    list-servers \
        'iris-gaia-red'
    list-servers \
        'iris-gaia-green'
    list-servers \
        'iris-gaia-blue'


# -----------------------------------------------------
# Create large high memory (himem.54vcpu) instances on each cloud.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.himem.54vcpu' \
        2

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.himem.54vcpu' \
        2

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.himem.54vcpu' \
        2

# -----------------------------------------------------
# Fill in with standard large (54vcpu) instances.
#[root@ansibler]

    create-servers \
        'iris-gaia-red' \
        'gaia.vm.cclake.54vcpu' \
        6

    create-servers \
        'iris-gaia-green' \
        'gaia.vm.cclake.54vcpu' \
        6

    create-servers \
        'iris-gaia-blue' \
        'gaia.vm.cclake.54vcpu' \
        6

    list-active \
        'iris-gaia-red'
    list-active \
        'iris-gaia-green'
    list-active \
        'iris-gaia-blue'

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-red]
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   6
    >   
    >   "gaia.vm.cclake.himem.54vcpu"
    >   "gaia.vm.cclake.himem.54vcpu"
    >   2

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-green]
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   6
    >   
    >   "gaia.vm.cclake.himem.54vcpu"
    >   "gaia.vm.cclake.himem.54vcpu"
    >   2

    >   ---- ----
    >   Listing active
    >     Cloud [iris-gaia-blue]
    >   "gaia.vm.cclake.54vcpu"
    >   "gaia.vm.cclake.54vcpu"
    >   2

    #
    # 6 * 54vcpu on red
    # 2 * himem.54vcpu on red
    # 6 * 54vcpu on green
    # 2 * himem.54vcpu on green
    # 2 * 54vcpu on blue
    #
    # (6 * 54) + (2 * 54) + (6 * 54) + (2 * 54) + (2 * 54)
    # total 972 vcpu
    #






